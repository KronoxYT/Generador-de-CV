{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile in the VitaeForge application, containing personal information, contact details, and preferences.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity."
        },
        "firstName": {
          "type": "string",
          "description": "The user's first name."
        },
        "lastName": {
          "type": "string",
          "description": "The user's last name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The user's phone number."
        },
        "address": {
          "type": "string",
          "description": "The user's physical address."
        },
        "linkedInUrl": {
          "type": "string",
          "description": "The URL to the user's LinkedIn profile.",
          "format": "uri"
        },
        "githubUrl": {
          "type": "string",
          "description": "The URL to the user's GitHub profile.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email"
      ]
    },
    "WorkExperience": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WorkExperience",
      "type": "object",
      "description": "Represents a user's work experience entry in their CV.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the WorkExperience entity."
        },
        "userProfileId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N WorkExperience)"
        },
        "jobTitle": {
          "type": "string",
          "description": "The user's job title at the company."
        },
        "companyName": {
          "type": "string",
          "description": "The name of the company where the user worked."
        },
        "startDate": {
          "type": "string",
          "description": "The start date of the employment.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "The end date of the employment. Can be null if currently employed.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "A description of the user's responsibilities and achievements at the company."
        }
      },
      "required": [
        "id",
        "userProfileId",
        "jobTitle",
        "companyName",
        "startDate"
      ]
    },
    "Education": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Education",
      "type": "object",
      "description": "Represents a user's educational background in their CV.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Education entity."
        },
        "userProfileId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Education)"
        },
        "institutionName": {
          "type": "string",
          "description": "The name of the educational institution."
        },
        "degree": {
          "type": "string",
          "description": "The degree earned by the user."
        },
        "major": {
          "type": "string",
          "description": "The user's major field of study."
        },
        "graduationDate": {
          "type": "string",
          "description": "The date of graduation.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "A description of the user's studies and achievements at the institution."
        }
      },
      "required": [
        "id",
        "userProfileId",
        "institutionName",
        "degree",
        "major",
        "graduationDate"
      ]
    },
    "Skill": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Skill",
      "type": "object",
      "description": "Represents a skill possessed by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Skill entity."
        },
        "userProfileId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Skill)"
        },
        "name": {
          "type": "string",
          "description": "The name of the skill."
        },
        "level": {
          "type": "string",
          "description": "The user's proficiency level in the skill (e.g., Beginner, Intermediate, Expert)."
        }
      },
      "required": [
        "id",
        "userProfileId",
        "name",
        "level"
      ]
    },
    "Template": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Template",
      "type": "object",
      "description": "Represents a CV template available in the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Template entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the template."
        },
        "description": {
          "type": "string",
          "description": "A description of the template's style and suitability."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL to the template's preview image.",
          "format": "uri"
        },
        "templateData": {
          "type": "string",
          "description": "JSON data representing the template's structure and styling."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "imageUrl",
        "templateData"
      ]
    },
    "CV": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CV",
      "type": "object",
      "description": "Represents a single CV document created by a user.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The user-defined name for the CV (e.g., 'CV for Software Engineer')."
        },
        "lastEdited": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of the last modification."
        },
        "personal": {
          "type": "object"
        },
        "summary": {
          "type": "string"
        },
        "experience": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "education": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "skills": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "font": {
          "type": "string"
        }
      },
      "required": [
        "name",
        "lastEdited"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information.  Owned by the user. Authorization: `request.auth.uid == userId`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/cvs/{cvId}",
        "definition": {
          "entityName": "CV",
          "schema": {
            "$ref": "#/backend/entities/CV"
          },
          "description": "Stores a user's CV document. Owned by the user. Authorization: `request.auth.uid == userId`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "cvId",
              "description": "The unique identifier for the CV."
            }
          ]
        }
      },
      {
        "path": "/templates/{templateId}",
        "definition": {
          "entityName": "Template",
          "schema": {
            "$ref": "#/backend/entities/Template"
          },
          "description": "Stores CV templates. Globally accessible, read-only for users. Admin-writeable.",
          "params": [
            {
              "name": "templateId",
              "description": "The unique identifier for the template."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to be secure and scalable. User-specific data, including their CVs, are stored in a subcollection under their unique user ID (`/users/{userId}/cvs/{cvId}`), ensuring that a user can only access their own data through path-based security rules. This avoids costly and insecure `get()` calls in rules. Global data, like CV templates, is stored in a separate top-level collection (`/templates`) with read-only access for all users, protecting its integrity."
  }
}
